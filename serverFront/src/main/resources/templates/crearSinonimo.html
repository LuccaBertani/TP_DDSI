<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout/base :: html}">
<main th:fragment="contenido">

    <section class="contribute-hero">
        <div class="container position-relative">
            <div class="row align-items-center justify-content-center">
                <div class="col-lg-8 text-center">
                    <span class="contribute-badge mb-3">
                        <i class="bi bi-link-45deg"></i>
                        <span>Gestión de datos</span>
                    </span>

                    <h1 class="display-5 fw-bold mb-2 animated-gradient-text">
                        Crear Sinónimo
                    </h1>
                    <p class="lead text-muted mb-0">
                        Agregá un sinónimo para categorías, países o provincias
                    </p>
                </div>
            </div>
        </div>
    </section>

    <section class="container pb-5">
        <div class="row justify-content-center">
            <div class="col-lg-7 col-xl-6">
                <div class="form-card">
                    <form th:action="@{/gestion/sinonimos/crear}" method="get" th:object="${sinonimoForm}">

                        <input type="hidden" id="hiddenEntidad" name="id_entidad"
                               th:value="${sinonimoForm.id_entidad}"/>

                        <div class="form-group-custom">
                            <label class="form-label-custom" for="tipo">
                                <i class="bi bi-diagram-3 me-2"></i>Tipo de sinónimo
                            </label>
                            <select class="form-control-custom" id="tipo" th:field="*{tipo}" required>
                                <option value="">Seleccionar tipo</option>
                                <option value="categoria">Categoría</option>
                                <option value="pais">País</option>
                                <option value="provincia">Provincia</option>
                            </select>
                            <small class="form-hint">Elegí el tipo de entidad para la cual crearás el sinónimo</small>
                        </div>

                        <div class="form-group-custom">
                            <label class="form-label-custom">
                                <i class="bi bi-tag me-2"></i>Entidad
                            </label>

                            <div id="grupoCategoria" class="d-none">
                                <select class="form-control-custom" onchange="syncEntidad(this.value)">
                                    <option value="">Seleccionar categoría</option>
                                    <option th:each="cat : ${categorias}"
                                            th:value="${cat.id}"
                                            th:text="${cat.categoria}"
                                            th:selected="${sinonimoForm.id_entidad != null and sinonimoForm.id_entidad == cat.id}">
                                    </option>
                                </select>
                            </div>

                            <div id="grupoPais" class="d-none">
                                <select class="form-control-custom" onchange="syncEntidad(this.value)">
                                    <option value="">Seleccionar país</option>
                                    <option th:each="p : ${paises}"
                                            th:value="${p.id}"
                                            th:text="${p.pais}"
                                            th:selected="${sinonimoForm.id_entidad != null and sinonimoForm.id_entidad == p.id}">
                                    </option>
                                </select>
                            </div>

                            <div id="grupoProvincia" class="d-none">
                                <select class="form-control-custom mb-3"
                                        id="selectPaisParaProvincia"
                                        name="id_pais"
                                        onchange="this.form.submit()">
                                    <option value="">Primero seleccionar país</option>
                                    <option th:each="p : ${paises}"
                                            th:value="${p.id}"
                                            th:text="${p.pais}"
                                            th:selected="${sinonimoForm.id_pais != null && sinonimoForm.id_pais == p.id}">
                                    </option>
                                </select>

                                <select class="form-control-custom"
                                        id="selectProvincia"
                                        th:disabled="${provincias == null}"
                                        onchange="syncEntidad(this.value)">
                                    <option value="">Luego seleccionar provincia</option>
                                    <option th:each="pr : ${provincias}"
                                            th:value="${pr.id}"
                                            th:text="${pr.provincia}"
                                            th:selected="${sinonimoForm.id_entidad != null && sinonimoForm.id_entidad == pr.id}">
                                    </option>
                                </select>
                            </div>

                            <small class="form-hint">Seleccioná la entidad principal a la que asociarás el sinónimo</small>
                        </div>

                        <div class="form-group-custom highlight-input">
                            <label class="form-label-custom" for="sinonimo">
                                <i class="bi bi-bookmark me-2"></i>Sinónimo
                            </label>
                            <input type="text"
                                   class="form-control-custom"
                                   id="sinonimo"
                                   th:field="*{sinonimo}"
                                   placeholder="Ej: CABA, Incendio, etc."
                                   required />
                            <small class="form-hint">Ingresá el término alternativo que quieras asociar</small>
                        </div>

                        <div class="form-actions">
                            <a class="btn btn-outline-secondary btn-lg" th:href="@{/usuarios/perfil}">
                                <i class="bi bi-arrow-left me-2"></i>Cancelar
                            </a>

                            <button class="btn btn-primary btn-lg"
                                    formaction="/gestion/sinonimos/crear"
                                    formmethod="post"
                                    type="submit">
                                <i class="bi bi-check2-circle me-2"></i>Crear Sinónimo
                            </button>

                            <input type="hidden" th:if="${_csrf != null}"
                                   th:name="${_csrf.parameterName}"
                                   th:value="${_csrf.token}"/>
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </section>

    <style>
        .contribute-hero {
            padding: 80px 0 40px;
            background: radial-gradient(ellipse 1400px 800px at 50% -100px, rgba(102,126,234,.12) 0%, transparent 50%);
            position: relative;
            overflow: hidden;
        }

        .contribute-hero::before {
            content: '';
            position: absolute;
            inset: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%236b5cff' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            pointer-events: none;
        }

        .contribute-badge {
            background: linear-gradient(135deg, rgba(79,70,229,.12), rgba(129,140,248,.12));
            color: #4f46e5;
            padding: .6rem 1.5rem;
            border-radius: 999px;
            font-size: .85rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: .4rem;
            border: 1px solid rgba(79,70,229,.22);
        }

        .form-card {
            background: #fff;
            border-radius: 24px;
            padding: 2.5rem;
            box-shadow: 0 4px 20px rgba(0,0,0,.08);
            border: 1px solid rgba(0,0,0,.06);
        }

        .form-group-custom {
            margin-bottom: 2rem;
        }

        .form-label-custom {
            font-weight: 600;
            color: #1a202c;
            margin-bottom: .75rem;
            display: flex;
            align-items: center;
            font-size: .95rem;
        }

        .form-control-custom {
            width: 100%;
            padding: .875rem 1.125rem;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            font-size: .95rem;
            transition: all .2s ease;
            background: #fff;
        }

        .form-control-custom:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102,126,234,.1);
        }

        .form-control-custom:disabled {
            background: #f8f9fa;
            cursor: not-allowed;
        }

        .form-hint {
            display: block;
            color: #64748b;
            font-size: .85rem;
            margin-top: .5rem;
        }

        .highlight-input {
            background: linear-gradient(135deg, #f8f9ff 0%, #fff 100%);
            border-radius: 16px;
            padding: 1.5rem;
            border: 2px dashed #e9ecef;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2.5rem;
            padding-top: 2rem;
            border-top: 1px solid #e9ecef;
        }

        .btn {
            border-radius: 12px;
            font-weight: 600;
            transition: all .2s ease;
            flex: 1;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            box-shadow: 0 4px 12px rgba(102,126,234,.25);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #5568d3 0%, #63408b 100%);
            box-shadow: 0 6px 16px rgba(102,126,234,.35);
        }

        .btn-outline-secondary {
            border: 2px solid #e9ecef;
            color: #64748b;
        }

        .btn-outline-secondary:hover {
            background: #f8f9fa;
            border-color: #cbd5e0;
            color: #1a202c;
        }

        @media (max-width: 768px) {
            .contribute-hero {
                padding: 3rem 0 2rem;
            }

            .display-5 {
                font-size: 2rem;
            }

            .form-card {
                padding: 1.5rem;
            }

            .form-actions {
                flex-direction: column;
            }
        }
    </style>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const tipoSelect = document.getElementById('tipo');
            const grupoCategoria = document.getElementById('grupoCategoria');
            const grupoPais = document.getElementById('grupoPais');
            const grupoProvincia = document.getElementById('grupoProvincia');

            function ocultarTodos() {
                grupoCategoria.classList.add('d-none');
                grupoPais.classList.add('d-none');
                grupoProvincia.classList.add('d-none');
            }

            function actualizarSegunTipo() {
                const tipo = tipoSelect.value;
                ocultarTodos();

                if (tipo === 'categoria') grupoCategoria.classList.remove('d-none');
                if (tipo === 'pais') grupoPais.classList.remove('d-none');
                if (tipo === 'provincia') grupoProvincia.classList.remove('d-none');
            }

            tipoSelect.addEventListener('change', actualizarSegunTipo);
            actualizarSegunTipo();
        });

        function syncEntidad(value) {
            document.getElementById('hiddenEntidad').value = value;
        }
    </script>

</main>
</html>